Vite and Module Federation Makes Micro-Frontends EASY! (https://www.youtube.com/watch?v=t-nchkL9yIg)

https://github.com/jherr/vite-mod-fed
https://github.com/Annie-Huang/vite-mod-fed
Keep in mind this tutorial is created in  4 Apr 2023 and I am doing this in 12/05/2024.
And I am doing it in typescript as well. so bound to have a lot of lib upgrade and twisting.

https://github.com/originjs/vite-plugin-federation

---------------------------------------------------------------------

PS C:\react\vite-mod-fed> pnpm create vite remote --template react-ts

Scaffolding project in C:\react\vite-mod-fed\remote...

Done. Now run:

  cd remote
  pnpm install
  pnpm run dev

PS C:\react\vite-mod-fed> cd .\remote\
PS C:\react\vite-mod-fed\remote> pnpm add @originjs/vite-plugin-federation -D
PS C:\react\vite-mod-fed\remote> npm run dev
PS C:\react\vite-mod-fed\remote> pnpm add jotai
http://localhost:5001/


Whenever you change a vite.config.ts file, you will need to:
PS C:\react\vite-mod-fed\remote> npm run build      <-- create the remoteEntry.js file
PS C:\react\vite-mod-fed\remote> npm run serve  (or npm run preview)
http://localhost:5001/assets/remoteEntry.js     <-- To check if the remote bundle is created successfully.



-----------------------------------

PS C:\react\vite-mod-fed> pnpm create vite host --template react-ts

Scaffolding project in C:\react\vite-mod-fed\host...

Done. Now run:

  cd host
  pnpm install
  pnpm run dev

PS C:\react\vite-mod-fed> cd .\host\
PS C:\react\vite-mod-fed\host> pnpm install
PS C:\react\vite-mod-fed\host> pnpm add @originjs/vite-plugin-federation -D
PS C:\react\vite-mod-fed\host> npm run dev
http://localhost:5173/      <-- it will randomly sprint up the port number as we didn't enforce it to certain port number.



----------------------------------------------------------

"dev": "vite --port 5001 --strictPort",
The ""--port 5001 --strictPort" part meaning running in port 5001, and if you couldn't get hold of 5001, don't do anything, just fail silently.
Only the remote need to have a specific port because all other app is going to reference this port number for remote setting.
But the host app does not matter which port it is using


The location of the remoteEntry.js file:
This is going into the assets directory and that's because this remoteEntry file and all of the bundles that are references are just JavaScript files.
And they should be treated and deployed like assets. So what happens to the sharing between two applications if the application that's sharing that component
that I rely on goes down? Well, nothing, because what you should do is you should go and deploy your assets, in this case,
all your CSS, your JavaScript, your images, all of it should be deployed to a static asset store, and that includes all the federate modules.
So yes, your application could go down, but that's just the server side of your application. The static assets should never go down because those should
always be deployed on something like S3, which is never going to go down. And if S3 goes go down, well, then it's a holiday for everybody, so don't worry about that.


shared: ['react', 'react-dom']
So we don't en dup downloading multiple copies because that would just be bad for both performance and also for the stability of the app.
So this allows for the module federation to arbitrate between the host and remote and say, Hey, I've got React. Great, you've got React. Cool.

Share state
One of the thing you want to do with micro frontend is share a state between the host application and the micro frontend, for example, the user ID.
Now the way that I strongly recommend doing that is with an atomic state manager, either Recoil or Jotai. Both of those work well.
E.g.
We're going to have a shared state store in remote application that's going to hold the value for click me and then we're going to
attach to that in the application itself so taht when I click 'click me', count update and we shared between the two button in the remote app.
It's pretty rudimentary but it will show sharing between the host application, in this case remote and its own button.
And then over the Host application, we'll do the same thing in host. so we'll see how to share state and subscribe to shared state.
https://recoiljs.org/
https://jotai.org/









